<!DOCTYPE html>
<html xmlns:tal="http://xml.zope.org/namespaces/tal"
      xmlns:metal="http://xml.zope.org/namespaces/metal"
      metal:define-macro="main"
      xmlns:i18n="http://xml.zope.org/namespaces/i18n"
      i18n:domain="substanced"
      tal:define="mp request.sdiapi.mgmt_path;
      su request.static_url;
      sdititle request.sdiapi.sdi_title()">
  <head>
    
    <more tal:omit-tag="" metal:define-slot="head-first"></more>

    <meta charset="utf-8"/>
    <title metal:define-slot="page-title">${view.title | request.sdiapi.sdi_title()}</title>
    <meta name="viewport"
          content="width=device-width, initial-scale=1.0"/>

    <!-- HTML5 shim, for IE6-8 support of HTML elements -->
    <!--[if lt IE 9]>
    <script src="https://html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Styles -->
    <!--! sdi_bootstrap.css includes bootstrap and sdi-specific css generated by LESS -->
    <link href="${su('substanced.sdi:static/css/sdi_bootstrap.css')}"
          rel="stylesheet"/>

    <!-- Fav icons -->
    <link rel="shortcut icon"
          href="${su('substanced.sdi:static/img/favicon.ico')}"/>

    <!-- Scripts -->
    <script src="${su('substanced.sdi:static/js/jquery-2.0.3.js')}"
            type="text/javascript"></script>
    <script src="${su('substanced.sdi:static/js/bootstrap.js')}"
            type="text/javascript"></script>
    <script src="${su('substanced.sdi:static/js/sdi.js')}"
            type="text/javascript"></script>

    <more tal:omit-tag="" metal:define-slot="head-more"></more>

  </head>

  <body>

    <img class="loading-indicator"
         id="sdi-loading-img" 
         src="${su('substanced.sdi:static/img/progress_bar.gif')}"
         style="display:none;" 
         alt="Loading indicator"/>

    <div class="navbar navbar-default navbar-fixed-top nav-bordered-bottom">
      <div class="container">

        <div class="col-md-10 breadcrumbs-bounding"
             tal:define="breadcrumbs request.sdiapi.breadcrumbs()">

          <ul tal:condition="breadcrumbs"
              class="breadcrumb">
            <tal:breadcrumbs repeat="breadcrumb breadcrumbs">
              <li tal:attributes="class breadcrumb['active']"
                  title="${breadcrumb['content_type']} '${breadcrumb['name']}'">
                <i class="${breadcrumb['icon']}"> </i>
                <a href="${breadcrumb['url']}">${breadcrumb['name']}</a>
              </li>
            </tal:breadcrumbs>
          </ul>

          <a tal:condition="not breadcrumbs"
             tal:define="sdititle request.sdiapi.sdi_title();
                         home_path request.sdiapi.mgmt_path(request.virtual_root)"
             class="navbar-brand"
             href="${home_path}"><img 
                    alt="${sdititle}"
                    src="${request.static_url('substanced.sdi:static/img/capsule-icon-32.png')}"
                    />${sdititle}</a>

        </div>
        <div class="col-md-2 user-dropdown-bounding">
          <div class="pull-right hidden-xs hidden-sm visible-lg visible-md">

            <div tal:condition="request.user">
              <button type="button" class="btn btn-primary dropdown-toggle" 
                      data-toggle="dropdown">
                <i class="glyphicon glyphicon-user" style="margin-right: 5px;"></i>${request.user.__name__}<span class="caret" style="margin-left: 8px;"></span>
              </button>
              <ul class="dropdown-menu pull-right">
                <li>
                  <a href="${mp(request.user, '')}" i18n:translate="">
                    <i i18n:name="icon" class="glyphicon glyphicon-pencil"></i> Account</a>
                </li>
                <li>
                  <a href="${mp(request.root, '@@logout')}" i18n:translate="">
                    <i i18n:name="icon" class="glyphicon glyphicon-off"></i> Log Out</a>
                </li>
              </ul>
            </div>

          </div>
        </div>
      </div>
    </div>

    <div class="container">

      <metal:slot metal:define-slot="outer-content">

        <div class="row">

          <div class="col-md-12">

            <ul class="nav nav-tabs"
                tal:define="tabs request.sdiapi.mgmt_views(context)"
                tal:condition="tabs">
              <li tal:repeat="tab_data tabs"
                  tal:attributes="class tab_data['class']">
                <a href="${tab_data['url']}">${tab_data['title']}</a>
              </li>
            </ul>

            <div class="above-content">
            </div>

            <div id="messages"
                 tal:attributes="class request.is_xhr and 'ajax-replace' or None">
              <div tal:repeat="queue ('', 'info', 'success', 'warning', 'danger')"
                   tal:omit-tag="">
                <div class="alert alert-${queue or 'info'}"
                     tal:define="messages request.session.pop_flash(queue)"
                     tal:condition="messages"
                     tal:repeat="message messages">
                  <button type="button" class="close" data-dismiss="alert">&times;</button>
                  ${structure:message}
                </div>
              </div>
            </div>

            <div class="inner-content">
              <div metal:define-slot="main">
              </div>
            </div>

            <div class="below-content">
            </div>

          </div>

        </div>

      </metal:slot>

    </div>

    <more tal:omit-tag="" metal:define-slot="tail-more"></more>

  </body>

</html>
